<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | An√°lise de Virtualiza√ß√£o</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* --- GERAL --- */
        :root {
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --text-color: #333;
            --text-color-light: #555;
            --bg-color: #f0f2f5;
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
            --accent-color: #007aff;
            --accent-color-hover: #0056b3;
            --shadow-color: rgba(0, 0, 0, 0.09);
            --table-header-bg: #f8f9fa;
            --table-row-bg: #fdfdfd;
            --grid-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --text-color: #e0e0e0;
            --text-color-light: #a0a0a0;
            --bg-color: #1a1a1a;
            --sidebar-bg: #232323;
            --card-bg: #2c2c2c;
            --border-color: #444;
            --accent-color: #007aff;
            --accent-color-hover: #2a8fff;
            --shadow-color: rgba(0, 0, 0, 0.25);
            --table-header-bg: #343a40;
            --table-row-bg: #303030;
            --grid-color: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
            display: flex;
            background-color: var(--bg-color); 
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- SIDEBAR (NAVEGA√á√ÉO) --- */
        .sidebar {
            width: 240px;
            background-color: var(--sidebar-bg);
            padding: 20px;
            flex-shrink: 0;
            box-shadow: 0 2px 8px var(--shadow-color);
            z-index: 10;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s;
        }
        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .sidebar-header h2 {
            margin: 0;
            font-size: 1.2rem;
            color: var(--text-color);
        }
        .sidebar nav {
            flex-grow: 1;
        }
        .sidebar nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar nav ul li {
            margin-bottom: 10px;
        }
        .sidebar nav ul li a {
            text-decoration: none;
            color: var(--text-color-light);
            display: block;
            padding: 10px 15px;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.2s, color 0.2s;
        }
        .sidebar nav ul li a:hover,
        .sidebar nav ul li a.active {
            background-color: var(--accent-color);
            color: #fff;
        }
        .theme-switcher {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            background: var(--bg-color);
            border-radius: 8px;
            cursor: pointer;
        }
        .theme-switcher span {
            margin: 0 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }
        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent-color);
        }
        input:checked + .slider:before {
            transform: translateX(20px);
        }

        /* --- CONTE√öDO PRINCIPAL --- */
        .main-content {
            flex-grow: 1;
            padding: 30px;
            overflow-y: auto;
            height: 100vh;
            box-sizing: border-box;
        }

        h1, h2, h3 {
            color: var(--text-color);
            margin-top: 0;
        }
        h1 {
            font-size: 2rem;
            margin-bottom: 30px;
        }
        h2 {
            font-size: 1.5rem;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 5px;
        }
        h3 {
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .card.full-width {
            grid-column: 1 / -1;
        }

        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }
        
        .summary-text p {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-color-light);
        }

        .table-container {
            overflow-x: auto;
        }

        table.data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        table.data-table th, 
        table.data-table td {
            border: 1px solid var(--border-color);
            padding: 10px 12px;
            text-align: left;
            vertical-align: top;
        }
        table.data-table th {
            background-color: var(--table-header-bg);
            font-weight: 600;
            white-space: nowrap;
        }
        table.data-table tr:nth-child(even) {
            background-color: var(--table-row-bg);
        }
        table.data-table td:first-child {
            font-weight: 500;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <!-- Barra Lateral -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>An√°lise de Virtualiza√ß√£o</h2>
        </div>
        <nav>
            <ul>
                <li><a href="#resumo" class="active">Resumo T√©cnico</a></li>
                <li><a href="#custos">An√°lise de TCO</a></li>
                <li><a href="#risco">Risco e Migra√ß√£o</a></li>
                <li><a href="#plano">Plano de Migra√ß√£o</a></li>
                <li><a href="#adicionais">An√°lises Adicionais</a></li>
                <li><a href="#tabelas">Tabelas Comparativas</a></li>
            </ul>
        </nav>
        
        <!-- Seletor de Tema -->
        <div classs="theme-switcher-wrapper">
             <div class="theme-switcher" id="theme-toggle">
                <span>‚òÄÔ∏è</span>
                <label class="switch">
                    <input type="checkbox" id="theme-checkbox">
                    <span class="slider"></span>
                </label>
                <span>üåô</span>
            </div>
        </div>
    </aside>

    <!-- Conte√∫do Principal -->
    <main class="main-content">
        
        <!-- Se√ß√£o: Resumo T√©cnico -->
        <section id="resumo">
            <h1>Resumo T√©cnico</h1>
            <div class="card summary-text">
                <p><strong>Gatilho:</strong> A recente mudan√ßa no licenciamento do VMware (Broadcom) tornou o custo da plataforma insustent√°vel, exigindo a avalia√ß√£o de alternativas para migra√ß√£o e redu√ß√£o de TCO.</p>
                <p><strong>An√°lise:</strong> Este dashboard compara as principais alternativas ao vSphere. Proxmox VE e Oracle Linux VM (OLVM) destacam-se pelo TCO mais baixo. Proxmox oferece um ecossistema open-source mais robusto e ferramentas nativas (Backup/Migra√ß√£o), enquanto Nutanix AHV e Scale Computing oferecem maior simplicidade de gest√£o, mas com custo elevado.</p>
                <p><strong>Recomenda√ß√£o:</strong> Para ambientes que buscam redu√ß√£o dr√°stica de custo e possuem expertise t√©cnica interna, <strong>Proxmox VE</strong> √© a recomenda√ß√£o principal devido ao TCO baixo e ao conjunto de recursos nativos. Para m√°xima simplicidade (abordagem "appliance"), <strong>Nutanix AHV</strong> ou <strong>Scale Computing</strong> s√£o vi√°veis, mas o TCO ser√° similar ou superior ao VMware. A migra√ß√£o para OpenShift Virtualization √© recomendada apenas se a estrat√©gia principal for a ado√ß√£o de cont√™ineres e Kubernetes.</p>
            </div>
        </section>

        <!-- Se√ß√£o: An√°lise de TCO -->
        <section id="custos">
            <h2>An√°lise de TCO (Custo Total de Propriedade)</h2>
            <div class="card full-width">
                <h3>Custo Total Estimado (5 Anos)</h3>
                <div class="chart-container">
                    <canvas id="tcoChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o: Risco e Complexidade -->
        <section id="risco">
            <h2>Risco e Complexidade de Migra√ß√£o</h2>
            <div class="card full-width">
                <h3>Matriz de Risco vs. Complexidade T√©cnica</h3>
                <div class="chart-container">
                    <canvas id="migrationChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o: Plano de Migra√ß√£o -->
        <section id="plano">
            <h2>Plano de Migra√ß√£o (Gantt)</h2>
            <div class="card full-width">
                <h3>Cronograma de Migra√ß√£o (Semanas)</h3>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="ganttChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o: An√°lises Adicionais -->
        <section id="adicionais">
            <h2>An√°lises Adicionais</h2>
            <div class="grid-container">
                <div class="card">
                    <h3>Simplicidade de Gest√£o</h3>
                    <div class="chart-container">
                        <canvas id="managementChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>For√ßa da Comunidade Open-Source</h3>
                    <div class="chart-container">
                        <canvas id="communityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o: Tabelas Comparativas -->
        <section id="tabelas">
            <h2>Tabelas Comparativas Detalhadas</h2>

            <div class="card full-width">
                <h3>Arquitetura e Desempenho</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Hipervisor Base</td>
                                <td>ESXi</td>
                                <td>KVM</td>
                                <td>KVM</td>
                                <td>KVM</td>
                                <td>KVM</td>
                                <td>KVM (via FusionSphere)</td>
                                <td>KVM (via KubeVirt)</td>
                            </tr>
                            <tr>
                                <td>Desempenho (Guest Linux)</td>
                                <td>Bom</td>
                                <td>Excelente</td>
                                <td>Excelente</td>
                                <td>Excelente</td>
                                <td>Excelente</td>
                                <td>Muito Bom</td>
                                <td>Excelente</td>
                            </tr>
                            <tr>
                                <td>Suporte Nativo a Cont√™ineres</td>
                                <td>Sim (Tanzu)</td>
                                <td>Sim (LXC)</td>
                                <td>Sim (Karbon)</td>
                                <td>N√£o</td>
                                <td>N√£o</td>
                                <td>Sim</td>
                                <td>Sim (Nativo do OpenShift)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card full-width" style="margin-top: 20px;">
                <h3>Continuidade de Neg√≥cios</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Replica√ß√£o S√≠ncrona Nativa</td>
                                <td>Sim (vSAN Stretched Cluster)</td>
                                <td>Sim (via Ceph)</td>
                                <td>Sim (Metro Availability)</td>
                                <td>Sim</td>
                                <td>N√£o</td>
                                <td>Sim (RPO=0)</td>
                                <td>Sim (via ODF)</td>
                            </tr>
                            <tr>
                                <td>Replica√ß√£o Ass√≠ncrona Nativa</td>
                                <td>Sim (vSphere Replication)</td>
                                <td>Sim (via Ceph/ZFS)</td>
                                <td>Sim (Async DR)</td>
                                <td>Sim (RPO 5 min)</td>
                                <td>N√£o (Requer 3¬∫s)</td>
                                <td>Sim</td>
                                <td>Sim (via ODF)</td>
                            </tr>
                            <tr>
                                <td>Orquestra√ß√£o de DR Nativa</td>
                                <td>Sim (SRM, pago)</td>
                                <td>Manual/Scripts</td>
                                <td>Sim (Prism Central)</td>
                                <td>Sim</td>
                                <td>N√£o (Requer 3¬∫s)</td>
                                <td>Sim (UltraVR)</td>
                                <td>Sim (via ACM)</td>
                            </tr>
                            <tr>
                                <td>Solu√ß√£o de Backup Nativa</td>
                                <td>N√£o</td>
                                <td>Sim (Proxmox Backup Server)</td>
                                <td>Sim (Snapshots/Replica√ß√£o)</td>
                                <td>Sim (Snapshots)</td>
                                <td>N√£o</td>
                                <td>Sim (eBackup)</td>
                                <td>Sim (OADP/Velero)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card full-width" style="margin-top: 20px;">
                <h3>Opera√ß√£o e Gerenciamento</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Simplicidade de Gest√£o</td>
                                <td>Moderada</td>
                                <td>Moderada</td>
                                <td>Excelente</td>
                                <td>Excelente</td>
                                <td>Moderada</td>
                                <td>Moderada-Alta</td>
                                <td>Alta (requer expertise Kubernetes)</td>
                            </tr>
                            <tr>
                                <td>Ferramenta de Migra√ß√£o VMware</td>
                                <td>N/A</td>
                                <td>Sim (Importador Integrado)</td>
                                <td>Sim (Nutanix Move)</td>
                                <td>Sim (SC//Migrate)</td>
                                <td>Sim (virt-v2v)</td>
                                <td>Sim (Rainbow)</td>
                                <td>Sim (MTV)</td>
                            </tr>
                            <tr>
                                <td>Balanceamento de Carga</td>
                                <td>DRS (Distribu√≠do)</td>
                                <td>Manual ou via terceiros</td>
                                <td>ADS (Nativo)</td>
                                <td>Failover autom√°tico</td>
                                <td>Pol√≠tica de agendamento</td>
                                <td>QoS e balanceamento nativo</td>
                                <td>Kubernetes Services / Rebalanceamento</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card full-width" style="margin-top: 20px;">
                <h3>Custo Total de Propriedade (TCO)</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Modelo de Licenciamento</td>
                                <td>Subscri√ß√£o por Core</td>
                                <td>Gratuito / Suporte Pago</td>
                                <td>Subscri√ß√£o HCI</td>
                                <td>Subscri√ß√£o HCI</td>
                                <td>Gratuito / Suporte Pago</td>
                                <td>Subscri√ß√£o por CPU</td>
                                <td>Subscri√ß√£o por Core</td>
                            </tr>
                            <tr>
                                <td>Custo de Software de Terceiros</td>
                                <td>$$(SRM, Veeam, etc.)</td>
                                <td>$ (PBS √© nativo/gratuito)</td>
                                <td>$ (Funcionalidade Nativa)</td>
                                <td>$ (Funcionalidade Nativa)</td>
                                <td>$$ (RackWare, etc.)</td>
                                <td>$ (Funcionalidade Nativa)</td>
                                <td>$ (OADP/Velero integrados)</td>
                            </tr>
                            <tr>
                                <td>Custo Total Estimado (5 Anos)</td>
                                <td>Muito Alto</td>
                                <td>Baixo</td>
                                <td>Muito Alto</td>
                                <td>Moderado</td>
                                <td>Muito Baixo</td>
                                <td>Alto</td>
                                <td>Alto</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card full-width" style="margin-top: 20px;">
                <h3>Seguran√ßa e Conformidade</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>RBAC (Controle de Acesso)</td>
                                <td>Sim (Avan√ßado)</td>
                                <td>Sim (Integrado)</td>
                                <td>Sim (Avan√ßado)</td>
                                <td>Sim (Foco no Appliance)</td>
                                <td>Sim (Integrado)</td>
                                <td>Sim (Avan√ßado)</td>
                                <td>Sim (Avan√ßado)</td>
                            </tr>
                            <tr>
                                <td>Criptografia Nativa</td>
                                <td>Sim</td>
                                <td>Sim (via ZFS/LUKS)</td>
                                <td>Sim</td>
                                <td>Sim</td>
                                <td>Sim (via LUKS)</td>
                                <td>Sim</td>
                                <td>Sim</td>
                            </tr>
                            <tr>
                                <td>Firewall Integrado</td>
                                <td>N√£o (Requer NSX)</td>
                                <td>Sim</td>
                                <td>Sim (Flow)</td>
                                <td>Sim</td>
                                <div>Sim (firewalld/iptables)</div>
                                <td>Sim</td>
                                <td>Sim (Network Policies)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card full-width" style="margin-top: 20px;">
                <h3>Ecossistema e Suporte</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Caracter√≠stica</th>
                                <th>VMware vSphere</th>
                                <th>Proxmox VE</th>
                                <th>Nutanix AHV</th>
                                <th>Scale Computing</th>
                                <th>Oracle Linux VM (OLVM)</th>
                                <th>Huawei DCS</th>
                                <th>Red Hat OpenShift Virt.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Op√ß√µes de Suporte Comercial</td>
                                <td>Premier (SLA corporativo)</td>
                                <td>N√≠veis Community a Premium</td>
                                <td>Production a Mission Critical</td>
                                <td>Suporte 24/7/365 ("ScaleCare")</td>
                                <td>Oracle Premier Support</td>
                                <td>N√≠veis Basic a Premier</td>
                                <td>Suporte Red Hat (SLA corporativo)</td>
                            </tr>
                            <tr>
                                <td>Comunidade Open-Source</td>
                                <td>Fraca</td>
                                <td>Muito Forte</td>
                                <td>Moderada</td>
                                <td>Fraca</td>
                                <td>Forte (oVirt)</td>
                                <td>Fraca</td>
                                <td>Muito Forte (Kubernetes)</td>
                            </tr>
                            <tr>
                                <td>Ciclo de Suporte Ativo</td>
                                <td>Longo (5+ anos)</td>
                                <td>Cont√≠nuo</td>
                                <td>3-5 anos por vers√£o</td>
                                <td>Cont√≠nuo com subscri√ß√£o</td>
                                <td>Longo (5+ anos)</td>
                                <td>3-5 anos por vers√£o</td>
                                <td>Curto (18-36 meses por vers√£o)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Espa√ßador no final para garantir que o scroll funcione bem -->
        <div style="height: 50px;"></div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chartInstances = {};

            // Mapeamento de valores para gr√°ficos
            const tcoData = {
                'Muito Baixo': 1, 'Baixo': 2, 'Moderado': 3, 'Alto': 4, 'Muito Alto': 5
            };
            const managementComplexityData = {
                'Excelente': 5, 'Moderada': 3, 'Moderada-Alta': 2, 'Alta (requer expertise Kubernetes)': 1
            };
            const communityData = {
                'Muito Forte': 5, 'Forte (oVirt)': 4, 'Moderada': 3, 'Fraca': 1
            };

            // Dados das Plataformas
            const platforms = [
                { name: 'VMware vSphere', tco: 'Muito Alto', complexity: 3, risk: 4, management: 'Moderada', community: 'Fraca' },
                { name: 'Proxmox VE', tco: 'Baixo', complexity: 2, risk: 2, management: 'Moderada', community: 'Muito Forte' },
                { name: 'Nutanix AHV', tco: 'Muito Alto', complexity: 1, risk: 3, management: 'Excelente', community: 'Moderada' },
                { name: 'Scale Computing', tco: 'Moderado', complexity: 1, risk: 2, management: 'Excelente', community: 'Fraca' },
                { name: 'Oracle Linux VM (OLVM)', tco: 'Muito Baixo', complexity: 4, risk: 3, management: 'Moderada', community: 'Forte (oVirt)' },
                { name: 'Huawei DCS', tco: 'Alto', complexity: 4, risk: 5, management: 'Moderada-Alta', community: 'Fraca' },
                { name: 'Red Hat OpenShift Virt.', tco: 'Alto', complexity: 5, risk: 4, management: 'Alta (requer expertise Kubernetes)', community: 'Muito Forte' }
            ];

            // Fun√ß√£o para renderizar/atualizar gr√°ficos
            function renderCharts() {
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                const labelColor = isDark ? '#e0e0e0' : '#333';
                const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

                // Cores distintas para o gr√°fico de dispers√£o
                const distinctColors = [
                    '#1f77b4', // Azul
                    '#ff7f0e', // Laranja
                    '#2ca02c', // Verde
                    '#d62728', // Vermelho
                    '#9467bd', // Roxo
                    '#8c564b', // Marrom
                    '#e377c2', // Rosa
                ];

                // Destruir gr√°ficos existentes para redesenhar
                Object.values(chartInstances).forEach(chart => chart.destroy());

                // --- Gr√°fico de TCO (Barras) ---
                let ctxTco = document.getElementById('tcoChart')?.getContext('2d');
                if (ctxTco) {
                    const sortedTco = [...platforms].sort((a, b) => tcoData[a.tco] - tcoData[b.tco]);
                    chartInstances.tco = new Chart(ctxTco, {
                        type: 'bar',
                        data: {
                            labels: sortedTco.map(p => p.name),
                            datasets: [{
                                label: 'Custo Estimado (5 Anos)',
                                data: sortedTco.map(p => tcoData[p.tco]),
                                backgroundColor: sortedTco.map(p => {
                                    const val = tcoData[p.tco];
                                    if (val <= 2) return 'rgba(75, 192, 192, 0.7)';
                                    if (val === 3) return 'rgba(255, 206, 86, 0.7)';
                                    return 'rgba(255, 99, 132, 0.7)';
                                }),
                                borderColor: 'rgba(255, 255, 255, 0)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: labelColor,
                                        callback: function(value) {
                                            return ['','Muito Baixo', 'Baixo', 'Moderado', 'Alto', 'Muito Alto'][value] || '';
                                        }
                                    },
                                    grid: { color: gridColor }
                                },
                                x: {
                                    ticks: { color: labelColor },
                                    grid: { color: 'transparent' }
                                }
                            },
                            plugins: {
                                legend: { display: false }
                            }
                        }
                    });
                }

                // --- Gr√°fico de Risco de Migra√ß√£o (Dispers√£o) ---
                let ctxMigration = document.getElementById('migrationChart')?.getContext('2d');
                if (ctxMigration) {
                    chartInstances.migration = new Chart(ctxMigration, {
                        type: 'scatter',
                        data: {
                            datasets: platforms.map((p, index) => ({
                                label: p.name,
                                data: [{ x: p.complexity, y: p.risk }],
                                backgroundColor: distinctColors[index % distinctColors.length],
                                pointRadius: 10,
                                pointHoverRadius: 15
                            }))
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    title: { display: true, text: 'Complexidade T√©cnica (1=Baixa, 5=Alta)', color: labelColor },
                                    min: 0, max: 6,
                                    ticks: { color: labelColor },
                                    grid: { color: gridColor }
                                },
                                y: {
                                    title: { display: true, text: 'Risco de Migra√ß√£o (1=Baixo, 5=Alto)', color: labelColor },
                                    min: 0, max: 6,
                                    ticks: { color: labelColor },
                                    grid: { color: gridColor }
                                }
                            },
                            plugins: {
                                legend: { position: 'bottom', labels: { color: labelColor } },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // --- Gr√°fico de Gantt (Barras Horizontais) ---
                let ctxGantt = document.getElementById('ganttChart')?.getContext('2d');
                if (ctxGantt) {
                    const ganttData = {
                        labels: ['Fase 4: Migra√ß√£o (Piloto)', 'Fase 3: Config. e Testes', 'Fase 2: Aquisi√ß√£o/Setup', 'Fase 1: An√°lise/Escolha'],
                        datasets: [
                            {
                                label: 'In√≠cio (Semana)',
                                data: [10, 6, 2, 0],
                                backgroundColor: 'transparent',
                            },
                            {
                                label: 'Dura√ß√£o (Semanas)',
                                data: [6, 4, 4, 2],
                                backgroundColor: ['#3e95cd', '#8e5ea2', '#3cba9f', '#e8c3b9'],
                            }
                        ]
                    };
                    chartInstances.gantt = new Chart(ctxGantt, {
                        type: 'bar',
                        data: ganttData,
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    stacked: true,
                                    title: { display: true, text: 'Tempo (Semanas)', color: labelColor },
                                    ticks: { color: labelColor },
                                    grid: { color: gridColor }
                                },
                                y: {
                                    stacked: true,
                                    ticks: { color: labelColor },
                                    grid: { color: 'transparent' }
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            if (context.datasetIndex === 1) {
                                                let label = ' Dura√ß√£o: ' + context.raw + ' semanas';
                                                return label;
                                            }
                                            return null;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // --- NOVO: Gr√°fico de Simplicidade de Gest√£o (Barras Horizontais) ---
                let ctxManagement = document.getElementById('managementChart')?.getContext('2d');
                if (ctxManagement) {
                    const sortedMgmt = [...platforms].sort((a, b) => managementComplexityData[a.management] - managementComplexityData[b.management]);
                    chartInstances.management = new Chart(ctxManagement, {
                        type: 'bar',
                        data: {
                            labels: sortedMgmt.map(p => p.name),
                            datasets: [{
                                label: 'Simplicidade de Gest√£o',
                                data: sortedMgmt.map(p => managementComplexityData[p.management]),
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: labelColor,
                                        callback: function(value) {
                                            return ['', 'Alta Complex.', 'Mod-Alta', 'Moderada', '', 'Excelente'][value] || '';
                                        }
                                    },
                                    grid: { color: gridColor }
                                },
                                y: {
                                    ticks: { color: labelColor },
                                    grid: { color: 'transparent' }
                                }
                            },
                            plugins: {
                                legend: { display: false }
                            }
                        }
                    });
                }

                // --- NOVO: Gr√°fico de Comunidade (√Årea Polar) ---
                let ctxCommunity = document.getElementById('communityChart')?.getContext('2d');
                if (ctxCommunity) {
                    const sortedComm = [...platforms].filter(p => communityData[p.community])
                                                     .sort((a, b) => communityData[b.community] - communityData[a.community]);
                    chartInstances.community = new Chart(ctxCommunity, {
                        type: 'polarArea',
                        data: {
                            labels: sortedComm.map(p => p.name),
                            datasets: [{
                                label: 'For√ßa da Comunidade',
                                data: sortedComm.map(p => communityData[p.community]),
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.7)',
                                    'rgba(54, 162, 235, 0.7)',
                                    'rgba(255, 206, 86, 0.7)',
                                    'rgba(75, 192, 192, 0.7)',
                                    'rgba(153, 102, 255, 0.7)',
                                    'rgba(255, 159, 64, 0.7)',
                                    'rgba(199, 199, 199, 0.7)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    ticks: {
                                        color: labelColor,
                                        backdropColor: 'transparent',
                                        callback: function(value) {
                                            return ['', 'Fraca', '', 'Moderada', 'Forte', 'Muito Forte'][value] || '';
                                        }
                                    },
                                    grid: { color: gridColor }
                                }
                            },
                            plugins: {
                                legend: { 
                                    position: 'bottom',
                                    labels: { color: labelColor }
                                }
                            }
                        }
                    });
                }
            }

            // --- L√≥gica do Seletor de Tema ---
            const themeToggle = document.getElementById('theme-toggle');
            const themeCheckbox = document.getElementById('theme-checkbox');
            
            // Checar prefer√™ncia do sistema
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeCheckbox.checked = true;
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                themeCheckbox.checked = false;
            }

            // Listener para o clique
            themeToggle.addEventListener('click', () => {
                const isChecked = themeCheckbox.checked;
                if (!isChecked) { // Invertendo a l√≥gica por causa do estado do checkbox
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
                themeCheckbox.checked = !isChecked; // Atualizar o estado visual
                
                // Redesenhar gr√°ficos com as cores do novo tema
                renderCharts();
            });

            // Listener para mudan√ßa de prefer√™ncia do sistema
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                const newColorScheme = e.matches ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', newColorScheme);
                themeCheckbox.checked = (newColorScheme === 'dark');
                renderCharts();
            });

            // Renderiza√ß√£o inicial
            renderCharts();
        });
    </script>

</body>
</html>

