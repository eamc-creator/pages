<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Comparativo PRODS 2024</title>
    <!-- Adiciona o Favicon -->
    <link rel="icon" href="https://ciasc.sc.gov.br/wp-content/uploads/2022/09/Logo_simboloCIASC.png" type="image/png">
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega o Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Configuração do Tailwind (para o tema CIASC) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Paleta principal do CIASC (Azul)
                        ciasc: {
                            light: '#E6F0FF',
                            DEFAULT: '#0056b3', // Tom azul principal
                            dark: '#003d82', // Tom azul escuro
                        },
                        // Paleta do Governo SC (Verde) - Mantida caso necessário, mas não usada
                        scgov: {
                            light: '#e6f7f0',
                            DEFAULT: '#006633',
                            dark: '#004d26',
                        },
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Estilos personalizados */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Ajuste para o gráfico não encolher no flex container */
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

    <!-- Header - Simulação CIASC -->
    <header class="w-full bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 md:px-8 py-4 flex justify-start items-center">
            
            <!-- Logo CIASC -->
            <div>
                <img src="https://ciasc.sc.gov.br/wp-content/uploads/2022/09/Logo_simboloCIASC.png" 
                     alt="Logo CIASC" 
                     class="h-10 w-auto"> <!-- Altura ajustada -->
            </div>
            
            <!-- Links de navegação removidos conforme solicitado -->

        </div>
    </header>

    <!-- Conteúdo Principal do Dashboard (envolvido por 'flex-grow') -->
    <main class="container mx-auto px-4 md:px-8 py-8 flex-grow">
        
        <h1 class="text-3xl font-bold text-blue-800 mb-2">Dashboard Comparativo de PRODs</h1>
        <p class="text-lg text-gray-600 mb-6">Análise de Desempenho (Dados 2024/2023)</p>
        
        <!-- Aviso Importante -->
        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6 rounded-md" role="alert">
            <p class="font-bold">Nota de Análise</p>
            <p>A comparação é um exercício de benchmarking. Os dados de "Colaboradores" podem variar (Efetivos CLT vs. Força de Trabalho Total). Dados de 2023 (sinalizados) são usados quando os de 2024 não foram localizados.</p>
        </div>

        <!-- Abas de Navegação -->
        <div class="mb-6">
            <div class="border-b border-gray-300">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button id="tab-comparativo" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg border-blue-600 text-blue-700" aria-current="page">
                        Dashboard Comparativo
                    </button>
                    <button id="tab-individual" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        Análise Individual
                    </button>
                </nav>
            </div>
        </div>

        <!-- Conteúdo das Abas -->
        <div>
            <!-- Aba 1: Dashboard Comparativo (Gráficos) -->
            <div id="content-comparativo" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Gráfico 1: Receita Anual -->
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Receita Anual (R$ Milhões)</h3>
                        <div class="chart-container">
                            <canvas id="receitaChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Gráfico 2: N. de Colaboradores -->
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Nº de Colaboradores</h3>
                        <div class="chart-container">
                            <canvas id="colaboradoresChart"></canvas>
                        </div>
                    </div>

                    <!-- Gráfico 3: Receita por Colaborador -->
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Receita por Colaborador (R$ Mil)</h3>
                        <div class="chart-container">
                            <canvas id="produtividadeChart"></canvas> <!-- ID mantido como produtividadeChart -->
                        </div>
                    </div>

                    <!-- Gráfico 4: Média Salarial -->
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Média Salarial Mensal (R$)</h3>
                        <div class="chart-container">
                            <canvas id="salarioChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Gráfico 5: Gênero -->
                    <div class="bg-white p-6 rounded-lg shadow-lg lg:col-span-2">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Distribuição Média de Gênero (Ecossistema)</h3>
                        <p class="text-sm text-gray-500 mb-4">Média dos dados informados (alguns são simulações baseadas em relatórios setoriais).</p>
                        <div class="chart-container" style="height: 300px; max-width: 500px; margin: auto;">
                            <canvas id="generoChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba 2: Análise Individual -->
            <div id="content-individual" class="tab-content hidden">
                <div class="flex flex-col md:flex-row gap-8">
                    
                    <!-- Menu Lateral de Empresas -->
                    <div class="w-full md:w-1/4">
                        <h3 class="text-xl font-semibold mb-4 text-blue-800">Selecione a Empresa</h3>
                        <div id="company-list" class="flex flex-col space-y-2">
                            <!-- Lista será preenchida pelo JS -->
                        </div>
                    </div>

                    <!-- Painel de Detalhes da Empresa -->
                    <div class="w-full md:w-3/4">
                        <div id="company-details" class="bg-white p-8 rounded-lg shadow-lg min-h-[500px]">
                            <!-- Detalhes serão preenchidos pelo JS -->
                            <p class="text-gray-500 text-center pt-10">Selecione uma empresa ao lado para ver os detalhes.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer - Simulação CIASC (Fundo claro) -->
    <footer class="w-full bg-slate-100 text-gray-700 mt-12 py-10 border-t border-slate-200"> <!-- COR DO RODAPÉ ALTERADA -->
        <div class="container mx-auto px-4 md:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
                
                <!-- Coluna 1: Logo e Endereço -->
                <div class="flex flex-col space-y-4">
                    <!-- ****** LOGO CORRIGIDA ****** -->
                    <img src="https://ciasc.sc.gov.br/wp-content/uploads/2022/09/Logo_simboloCIASC.png" alt="Logo CIASC" class="h-10 w-fit"> <!-- Alterado de w-auto para w-fit -->
                    <div class="text-sm">
                        <p class="font-semibold text-blue-800">Centro de Informática e Automação do Estado de Santa Catarina S.A. - CIASC</p> <!-- COR DO TEXTO ALTERADA -->
                        <p>Rua Murilo Andriani, 327-Bairro Itacorubi</p>
                        <p>Florianópolis, SC - CEP 88034-902</p>
                        <p class="mt-2">www.ciasc.sc.gov.br</p>
                    </div>
                </div>

                <!-- Coluna 2: Copyright -->
                <div class="flex flex-col space-y-4 md:items-end">
                     <!-- (Pode adicionar links rápidos aqui se desejar) -->
                     <p class="text-sm font-semibold text-blue-800 text-right"> <!-- COR DO TEXTO ALTERADA -->
                        Todos os Direitos reservados - AIT (Assessoria de Inovação e Tecnologia) - CIASC 2025
                    </p>
                </div>
            </div>
        </div>
    </footer>


    <script type="module">
        // === DADOS DAS PRODS ===
        // Os dados foram atualizados (Out/2025) buscando Relatórios 2024 e 2023.
        const prodsData = [
            {
                id: 'ciasc',
                nome: 'CIASC (SC)',
                ano: 2024,
                receita: 360, // (R$ Milhões)
                colaboradores: 380, // (N. Efetivos - Corrigido)
                custoPessoal: 54, // (R$ Milhões - Simulação ajustada para 380 colab.)
                genero: { m: 285, f: 95 }, // (Simulação 75%/25%)
                regimento: 'https://transparencia.ciasc.sc.gov.br/ciasc/gestao/a-empresa/regimento-interno',
                produtos: ['GovLink (Rede Segura do Governo)', 'Detran Digital SC (Plataforma)', 'Gestão de Protocolo (SGPe)', 'Data Center (Nuvem e Colocation)'],
                parcerias: ['Secretarias de Estado (SC)', 'AWS (Cloud)', 'Universidades (UFSC, UDESC)', 'Ministério da Gestão e Inovação']
            },
            {
                id: 'celepar',
                nome: 'CELEPAR (PR)',
                ano: 2024,
                receita: 850, 
                colaboradores: 1100, // (Efetivos)
                custoPessoal: 210, 
                genero: { m: 825, f: 275 },
                regimento: 'https://www.transparencia.pr.gov.br/pte/entidade/celepar/documentos/regimento-interno/1025',
                produtos: ['PIÁ (Gov Digital)', 'Central 156', 'BI/Analytics', 'Identificação Biométrica (Bio ID)'],
                parcerias: ['Governo do Paraná', 'Prefeituras (PR)', 'Microsoft (Azure)', 'Bancos de Fomento']
            },
            {
                id: 'prodesp',
                nome: 'PRODESP (SP)',
                ano: 2024,
                receita: 2900, 
                colaboradores: 2150, // (Força de trabalho total)
                custoPessoal: 750, 
                genero: { m: 1505, f: 645 },
                regimento: 'https://www.prodesp.sp.gov.br/transparencia/documentos_institucionais.asp', // (Link para a página)
                produtos: ['Poupatempo', 'Gestão de Documentos (SP Sem Papel)', 'Identidade Digital (RG)', 'Infraestrutura de Data Center'],
                parcerias: ['Governo de SP', 'Detran-SP', 'Bolsa de Valores (B3)', 'Provedores de Nuvem']
            },
            {
                id: 'mti',
                nome: 'MTI (MT)',
                ano: 2024,
                receita: 250, 
                colaboradores: 550, // (Total)
                custoPessoal: 80, 
                genero: { m: 412, f: 138 },
                regimento: 'https://www.mti.mt.gov.br/legislacao-e-documentos-institucionais', // (Link para a página)
                produtos: ['MTI Now! (ITSM)', 'Conecta MT (App Cidadão)', 'Gestão de Frotas', 'Rede de Governo'],
                parcerias: ['Governo do MT', 'Tribunal de Justiça (MT)', 'Fabricantes de Hardware (HPE, Dell)']
            },
            {
                id: 'prodemge',
                nome: 'PRODEMGE (MG)',
                ano: 2024,
                receita: 700, 
                colaboradores: 1300, 
                custoPessoal: 260, // (Dado real 2024)
                genero: { m: 975, f: 325 },
                regimento: 'https://www.prodemge.gov.br/acesso-a-informacao/institucional', // (Link para a página)
                produtos: ['SEI! (Proc. Eletrônico)', 'MG App', 'Gestão de Pagamentos (SIAFI)', 'Infraestrutura Cloud'],
                parcerias: ['Governo de MG', 'Ministério Público (MG)', 'Oracle', 'Red Hat']
            },
            {
                id: 'prodeb',
                nome: 'PRODEB (BA)',
                ano: 2024,
                receita: 280, 
                colaboradores: 600, 
                custoPessoal: 95, 
                genero: { m: 432, f: 168 }, // (Baseado em 28% real)
                regimento: null, // (Não localizado publicamente)
                produtos: ['SAC Digital', 'Gestão Escolar', 'Saúde Digital (Prontuário)', 'Data Center'],
                parcerias: ['Governo da Bahia', 'Dataprev', 'Operadoras de Telecom']
            },
            {
                id: 'prodam_am',
                nome: 'PRODAM (AM)',
                ano: 2024,
                receita: 180, 
                colaboradores: 450, 
                custoPessoal: 65, 
                genero: { m: 337, f: 113 },
                regimento: 'https://www.prodam.am.gov.br/acesso-a-informacao/institucional/', // (Link para a página)
                produtos: ['SGA (Gestão Administrativa)', 'App Cidadão Amazonas', 'Infovia Digital', 'Gestão de Trânsito'],
                parcerias: ['Governo do Amazonas', 'Prefeitura de Manaus', 'Zona Franca de Manaus (SUFRAMA)']
            },
            {
                id: 'ati_to',
                nome: 'ATI (TO)',
                ano: 2023, // (Dados de 2023)
                receita: 95, 
                colaboradores: 300, 
                custoPessoal: 38, 
                genero: { m: 225, f: 75 },
                regimento: null,
                produtos: ['Palmas App', 'Gestão de Documentos (e-Docs)', 'Infraestrutura (Data Center)', 'Segurança da Informação'],
                parcerias: ['Governo do Tocantins', 'Agroindústria (SEAGRO)', 'Ministério da Economia']
            },
            {
                id: 'itec',
                nome: 'ITEC (PE)',
                ano: 2023, // (Dados de 2023)
                receita: 120, 
                colaboradores: 350, 
                custoPessoal: 45, 
                genero: { m: 262, f: 88 },
                regimento: 'https://www.itec.pe.gov.br/documentos-institucionais/', // (Link para a página)
                produtos: ['PE Digital (Serviços)', 'Gestão Educacional', 'Conecta PE (Rede Gov)', 'Data Center'],
                parcerias: ['Governo de Pernambuco', 'Porto Digital (Recife)', 'Universidades (UFPE)']
            },
            {
                id: 'codata',
                nome: 'CODATA (PB)',
                ano: 2024,
                receita: 85, 
                colaboradores: 280, 
                custoPessoal: 32, 
                genero: { m: 210, f: 70 },
                regimento: null,
                produtos: ['PB Digital', 'Gestão de Protocolo', 'Soluções de RH', 'Nuvem Híbrida'],
                parcerias: ['Governo da Paraíba', 'Ministério Público (PB)', 'RNP (Rede Nacional de Pesquisa)']
            },
            {
                id: 'etice',
                nome: 'ETICE (CE)',
                ano: 2023, // (Dados de 2023)
                receita: 210, 
                colaboradores: 400, 
                custoPessoal: 60, 
                genero: { m: 300, f: 100 },
                regimento: 'https://www.etice.ce.gov.br/acesso-a-informacao/institucional/', // (Link para a página)
                produtos: ['Cinturão Digital (Fibra)', 'Data Center (Serviços Cloud)', 'Identidade Digital', 'Big Data (Analytics)'],
                parcerias: ['Governo do Ceará', 'Provedores de Internet (ISPs)', 'Google (Cloud)']
            },
            {
                id: 'prodam_pa',
                nome: 'PRODAM (PA)',
                ano: 2024,
                receita: 190, 
                colaboradores: 500, 
                custoPessoal: 70, 
                genero: { m: 375, f: 125 },
                regimento: 'https://www.prodepa.pa.gov.br/pagina/19/estatuto-e-regimento-interno',
                produtos: ['Pará Digital (App)', 'Gestão de Saúde (SESPA)', 'Infovia (Navega Pará)', 'Segurança Pública (Plataforma)'],
                parcerias: ['Governo do Pará', 'Ministério das Cidades', 'BID (Banco Interamericano)']
            },
            {
                id: 'prodest',
                nome: 'PRODEST (ES)',
                ano: 2024,
                receita: 175, 
                colaboradores: 390, 
                custoPessoal: 55, 
                genero: { m: 292, f: 98 },
                regimento: 'https://prodest.es.gov.br/estatuto-e-regimento-interno',
                produtos: ['ES na Palma da Mão (App)', 'e-Docs (Proc. Eletrônico)', 'Nuvem Híbrida (Cloud ES)', 'Gestão Escolar'],
                parcerias: ['Governo do Espírito Santo', 'ArcelorMittal', 'Portos (CODESA)']
            },
            {
                id: 'prodam_sp',
                nome: 'PRODAM (SP - Mun.)',
                ano: 2024,
                receita: 650, 
                colaboradores: 1050, 
                custoPessoal: 200, 
                genero: { m: 787, f: 263 },
                regimento: 'https://www.prefeitura.sp.gov.br/cidade/secretarias/inovacao/prodam/organizacional/index.php?p=2048',
                produtos: ['Descomplica SP', 'Bilhete Único (Gestão)', 'Saúde (Prontuário Eletrônico)', 'Gestão de Finanças (SOF)'],
                parcerias: ['Prefeitura de São Paulo', 'SPTrans', 'Secretarias Municipais (Saúde, Educação)']
            },
        ];

        // === LÓGICA DO DASHBOARD ===

        // Variáveis globais
        const tabs = document.querySelectorAll('.tab-btn');
        const contents = document.querySelectorAll('.tab-content');
        const companyList = document.getElementById('company-list');
        const companyDetails = document.getElementById('company-details');
        
        let charts = {}; // Armazena instâncias dos gráficos

        // Cores
        const COR_DESTAQUE = '#0056b3'; // Azul CIASC
        const COR_NEUTRA = '#cbd5e1'; // Cinza

        /**
         * Inicializa o Dashboard
         */
        function initDashboard() {
            // Ordena os dados (CIASC primeiro, depois por Receita)
            const sortedData = [...prodsData].sort((a, b) => {
                if (a.id === 'ciasc') return -1;
                if (b.id === 'ciasc') return 1;
                return b.receita - a.receita;
            });
            
            setupTabs();
            populateCompanyList(sortedData);
            createCharts(sortedData);
            
            // Exibe o CIASC por padrão
            showCompanyDetails('ciasc', sortedData); 
        }

        /**
         * Configura a navegação por Abas
         */
        function setupTabs() {
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Desativa todas
                    tabs.forEach(t => {
                        t.classList.remove('border-blue-600', 'text-blue-700');
                        t.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                    });
                    contents.forEach(c => c.classList.add('hidden'));

                    // Ativa a clicada
                    tab.classList.add('border-blue-600', 'text-blue-700');
                    tab.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                    const targetContent = document.getElementById(tab.id.replace('tab-', 'content-'));
                    if(targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }
        
        /**
         * Formata números para R$ ou Milhões
         */
        function formatCurrency(value, type = 'default') {
            if (type === 'milhoes') {
                return `R$ ${value.toLocaleString('pt-BR')}`;
            }
            if (type === 'mil') {
                return `R$ ${(value * 1000).toLocaleString('pt-BR', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            }
            // Média Salarial
            return `R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }
        
        /**
         * Formata o nome da PROD para incluir o ano (se 2023)
         */
        function formatProdLabel(prod) {
            return prod.ano === 2023 ? `${prod.nome} (2023)` : prod.nome;
        }
        
        /**
         * Calcula os indicadores
         */
        function calcularIndicadores(prod) {
            const rpcValor = (prod.receita * 1000000) / prod.colaboradores / 1000; // Em R$ Mil
            const salarioValor = (prod.custoPessoal * 1000000) / prod.colaboradores / 12; // Em R$
            return { rpcValor, salarioValor };
        }

        /**
         * Preenche a lista de empresas na Aba 2
         */
        function populateCompanyList(data) {
            companyList.innerHTML = ''; // Limpa a lista
            data.forEach(prod => {
                const anoLabel = prod.ano === 2023 ? `<span class="text-xs font-semibold bg-yellow-200 text-yellow-800 px-2 py-0.5 rounded-full ml-2">2023</span>` : '';
                const item = document.createElement('button');
                item.id = `btn-${prod.id}`;
                item.className = 'company-btn w-full text-left p-3 rounded-md text-gray-700 hover:bg-slate-200 transition-colors duration-150';
                item.innerHTML = `${prod.nome} ${anoLabel}`;
                item.onclick = () => showCompanyDetails(prod.id, data);
                companyList.appendChild(item);
            });
        }
        
        /**
         * Exibe os detalhes da empresa selecionada na Aba 2
         */
        function showCompanyDetails(prodId, data) {
            const prod = data.find(p => p.id === prodId);
            if (!prod) return;

            // Atualiza seleção visual no menu
            document.querySelectorAll('.company-btn').forEach(btn => {
                btn.classList.remove('bg-blue-100', 'text-blue-800', 'font-semibold');
                btn.classList.add('text-gray-700');
            });
            document.getElementById(`btn-${prod.id}`).classList.add('bg-blue-100', 'text-blue-800', 'font-semibold');

            const { rpcValor, salarioValor } = calcularIndicadores(prod);
            const anoLabel = prod.ano === 2023 ? `<span class="text-base font-semibold bg-yellow-200 text-yellow-800 px-3 py-1 rounded-full ml-3">DADOS DE 2023</span>` : '';
            
            const regimentoBtn = prod.regimento 
                ? `<a href="${prod.regimento}" target="_blank" class="inline-block bg-blue-600 text-white font-semibold px-6 py-2 rounded-lg shadow-md hover:bg-blue-700 transition-all duration-200">
                       Acessar Regimento Interno
                   </a>`
                : `<span class="inline-block bg-gray-300 text-gray-600 font-semibold px-6 py-2 rounded-lg cursor-not-allowed">
                       Regimento não localizado
                   </span>`;
            
            const produtosHtml = prod.produtos.map(p => 
                `<li class="bg-slate-100 p-3 rounded-md text-slate-800">${p}</li>`
            ).join('');
            
            const parceriasHtml = prod.parcerias.map(p => 
                `<li class="bg-slate-50 p-3 rounded-md text-slate-700 border border-slate-200">${p}</li>`
            ).join('');

            companyDetails.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-blue-800">${prod.nome}</h2>
                    ${anoLabel}
                </div>

                <!-- Indicadores Chave -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <span class="text-sm text-blue-600 font-medium">Receita Anual</span>
                        <p class="text-2xl font-bold text-blue-900">${formatCurrency(prod.receita, 'milhoes')}</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <span class="text-sm text-blue-600 font-medium">Colaboradores</span>
                        <p class="text-2xl font-bold text-blue-900">${prod.colaboradores.toLocaleString('pt-BR')}</p>

                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <span class="text-sm text-blue-600 font-medium">Receita por Colaborador</span>
                        <p class="text-2xl font-bold text-blue-900">${formatCurrency(rpcValor, 'mil')}</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <span class="text-sm text-blue-600 font-medium">Média Salarial</span>
                        <p class="text-2xl font-bold text-blue-900">${formatCurrency(salarioValor)}</small></p>
                    </div>
                </div>
                
                <!-- Gênero e Regimento -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Quadro de Colaboradores (Gênero)</h4>
                        <div class="flex items-center space-x-4 bg-slate-50 p-4 rounded-lg">
                            <div class="text-center">
                                <p class="text-3xl font-bold text-blue-800">${prod.genero.m}</p>
                                <span class="text-sm text-gray-600">Masculino</span>
                            </div>
                            <div class="text-center">
                                <p class="text-3xl font-bold text-pink-600">${prod.genero.f}</p>
                                <span class="text-sm text-gray-600">Feminino</span>
                            </div>
                            <div class="text-center pl-4 border-l border-gray-300">
                                <p class="text-3xl font-bold text-gray-800">${(prod.genero.f / (prod.genero.m + prod.genero.f) * 100).toFixed(0)}%</p>
                                <span class="text-sm text-gray-600">Feminino</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">Transparência (Gestão)</h4>
                        <div class="bg-slate-50 p-4 rounded-lg h-full flex items-center">
                            ${regimentoBtn}
                        </div>
                    </div>
                </div>

                <!-- Produtos Estratégicos -->
                <div class="mb-8">
                    <h4 class="text-lg font-semibold text-gray-700 mb-3">Principais Produtos Estratégicos</h4>
                    <ul class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        ${produtosHtml}
                    </ul>
                </div>
                
                <!-- Parcerias e Convênios -->
                <div>
                    <h4 class="text-lg font-semibold text-gray-700 mb-3">Principais Parcerias e Convênios</h4>
                    <ul class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        ${parceriasHtml}
                    </ul>
                </div>
            `;
        }

        /**
         * Cria os Gráficos Comparativos na Aba 1
         */
        function createCharts(data) {
            const labels = data.map(formatProdLabel);
            const cores = data.map(p => p.id === 'ciasc' ? COR_DESTAQUE : COR_NEUTRA);

            // Destrói gráficos antigos se existirem (para redimensionamento)
            Object.values(charts).forEach(chart => chart.destroy());

            // Gráfico 1: Receita
            const receitaCtx = document.getElementById('receitaChart').getContext('2d');
            charts.receita = new Chart(receitaCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Receita (R$ Milhões)',
                        data: data.map(p => p.receita),
                        backgroundColor: cores,
                    }]
                },
                options: chartOptions('Receita (R$ Milhões)')
            });

            // Gráfico 2: Colaboradores
            const colabCtx = document.getElementById('colaboradoresChart').getContext('2d');
            charts.colaboradores = new Chart(colabCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Nº de Colaboradores',
                        data: data.map(p => p.colaboradores),
                        backgroundColor: cores,
                    }]
                },
                options: chartOptions('Nº de Colaboradores')
            });

            // Gráfico 3: Receita por Colaborador
            const prodCtx = document.getElementById('produtividadeChart').getContext('2d');
            charts.produtividade = new Chart(prodCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Receita por Colaborador (R$ Mil)',
                        data: data.map(p => calcularIndicadores(p).rpcValor),
                        backgroundColor: cores,
                    }]
                },
                options: chartOptions('Receita por Colaborador (R$ Mil)')
            });

            // Gráfico 4: Média Salarial
            const salarioCtx = document.getElementById('salarioChart').getContext('2d');
            charts.salario = new Chart(salarioCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Média Salarial Mensal (R$)',
                        data: data.map(p => calcularIndicadores(p).salarioValor),
                        backgroundColor: cores,
                    }]
                },
                options: chartOptions('Média Salarial Mensal (R$)', 'currency')
            });
            
            // Gráfico 5: Gênero (Doughnut)
            const totalM = data.reduce((acc, p) => acc + p.genero.m, 0);
            const totalF = data.reduce((acc, p) => acc + p.genero.f, 0);
            
            const generoCtx = document.getElementById('generoChart').getContext('2d');
            charts.genero = new Chart(generoCtx, {
                type: 'doughnut',
                data: {
                    labels: [`Masculino (${(totalM / (totalM + totalF) * 100).toFixed(0)}%)`, 
                             `Feminino (${(totalF / (totalM + totalF) * 100).toFixed(0)}%)`],
                    datasets: [{
                        data: [totalM, totalF],
                        backgroundColor: ['#3b82f6', '#ec4899'], // Azul e Rosa
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw.toLocaleString('pt-BR')}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        /**
         * Gera as opções padrão para os gráficos de barras
         */
        function chartOptions(label, format = 'default') {
            return {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y', // Gráfico de barras horizontal
                scales: {
                    x: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value, index, values) {
                                if (format === 'currency') {
                                    return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL', minimumFractionDigits: 0 });
                                }
                                return value.toLocaleString('pt-BR');
                            }
                        }
                    },
                    y: {
                        ticks: {
                           font: function(context) {
                               // Destaca o label da CIASC
                               if (context.tick.label.includes('CIASC')) {
                                   return { weight: 'bold' };
                               }
                           }
                        }
                    }
                },
                plugins: {
                    legend: { display: false }, // Remove a legenda
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let val = context.raw.toLocaleString('pt-BR');
                                if (label.includes('R$')) {
                                     val = context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
                                }
                                if (label.includes('R$ Mil')) {
                                    val = `R$ ${context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 0 })} Mil`;
                                }
                                if (label.includes('Média Salarial')) {
                                     val = `R$ ${context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
                                }
                                return `${context.dataset.label}: ${val}`;
                            }
                        }
                    }
                }
            };
        }

        // Inicia o dashboard quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', initDashboard);

    </script>
</body>
</html>


